<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Sign up page</title>
	<style>
		body {
			width: 100%;
			height: 100%;
	
		}
		
		h3 {
			text-align: center;
		}
		
		button {
			border-radius: 6px;
			border: none;
			padding: 5px 8px;
		}
		
		.wrap {
			display: flex;
		 	justify-content:center; 
		  	align-items : center;
			width: 300px;
			height: 850px;
			margin: 0 auto;
		}
		
		.contents {
			width: 260px;
			height: 200px;
		}
		
		.wrap_btn{
			text-align: center;
		}
		
		.phone{
			width: 53px;
		}
		
		.w-100{
			width: 100%;
		}
	</style>
</head>
<script>

/* 유효성검사 */
function validation() {
// 	if(!id.value) {
//		alert("아이디를 입력해주세요!");
//		id.focus();
//		return;
//	}

//	if(!pw.value) {
//		alert("비밀번호를 입력해주세요!");
//		pw.focus();
//		return;
//	}

//	if(!pw.value) {
//		alert("비밀번호를 확인해주세요!");
//		pw.focus();
//		return;
//	}

//	if(!pw.value) {
//		alert("휴대폰 번호를 입력해주세요!");
//		pw.focus();
//		return;
//	}

	signUp(); // 회원가입
}


/* 회원가입 */
function signUp() {
	let form = document.getElementById("signUpForm");
	
	let formData = new FormData(form);

	// formData 값 객체 변환
	let dataInfo = {};
	formData.forEach((value, key) => dataInfo[key] = value);

	console.log(form);		//폼태그
	console.log(formData);	//폼데이터로 변환
	console.log(dataInfo);	//폼데이터를 객체로 변환
	
	console.log();
	
	// 회원가입 진행
	fetch( "/signUp.do", {
		  method: "post"
		  , headers: {
		    "Content-Type": 'application/json; charset=UTF-8',
		  }
		  , body: JSON.stringify({ dataInfo })
		})
		.then(response => {
		if(response.status == "404") {
			alert("컨트롤러 도꼬?");
			return;
		}
		if(response.status == "200") {
 	 		return response.json();
		}
	 	})
	.then(response => {
		console.log(response);

		let data = response.result;

		if(data.resultCode == "S") {
			alert("회원가입이 완료되었습니다!");
			document.location.href = "/login.do"; //로그인 페이지 이동
			
		} else {
			alert("회원가입 도중 예기치 못한 오류가 발생했어요!");
			return;
		}
	})
	.catch(err => {
	      console.log(err);
	})
}
</script>
<body>
	<div class="wrap">
		<div class="contents">
			<div class="wrap_input">
				<h3>Sign up here!</h3>
				<form id="signUpForm" name="signUpForm">
				    <input type="text" id="userId" class="w-100" name="userId" placeholder="id"><br>
				    <input type="text" id="password" class="w-100"	name="password" placeholder="password"><br>
				    <input type="text" id="passwordChk" class="w-100"	name="passwordChk" placeholder="check password"><br><br>
				    
				    <select id="phone1" class="phone" name="phone1">
				    	<option value="010">010</option>
				    </select>
				    <input type="text" class="phone" id="phone2" name="phone2">
				    <input type="text" class="phone" id="phone3" name="phone3">
				    
				    <br><br>
				    
				    <input type="text" id="zip" name="zip" placeholder="zip"><br>
				    <input type="text" id="address1" class="w-100" name="address1" placeholder="address"><br>
				    <input type="text" id="address2" class="w-100" name="address2" placeholder="address detail"><br>
				</form>
			</div>
		
			<br>
		
			<div class="wrap_btn">
				<button type="button" onclick="signUp(); return false;">회원가입</button>
				<button type="button" onclick="document.location.href = '/login.do'">취소</button>
			</div>
		</div>
	</div>
</body>
</html>